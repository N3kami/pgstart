Консольное приложение для установки PostgreSQL

Описание
Приложение устанавливает на минимально загруженный из указанных двух хостов сервер баз данных PostgreSQL (при равной загрузке берётся первый сервер).
Для установки сервера на целевых хостах должны быть такие системы как CentOS (AlmaLinux) или Debian.
Также необходимо, чтобы пользователь, из-под которого запускается приложение, имел закрытый ключ SSH, а на целевых хостах должен лежать публичный ключ под пользователем root.

Установка
Для установки необходимо скопировать репозиторий
На хосте, где запускается приложение, должен быть установлен Ansible, а также должны присутствовать модули community.general.ufw, ansible.posix.firewalld, Python в соответсвтии с версией Ansible (Web "Ansible Releases and maintenance"
На целевых хостах должен быть установлен python также в соответсвии версией Ansible

Использование
Для использования приложения необходимо запустить команду

python install_pgsql.py "server1, server2"

где server1 и server2 - это IP адреса первого и второго целевых хостов.
Приложение работает следующим образом: проверка валидности аргументов, проверка доступности данных хостов, проверка доступности сети Интернет с целевых хостов, проверка загруженности хостов и выбор наименее загруженного, подготовка шаблонной роли Ansible и inventory, выполнение плейбука по установке (установка необходимых компонентов, применение шаблонного конфига, открытие портов на ufw, firewall, iptables, создание пользователя), проверка доступности базы данных с другого хоста (пользователь student, запрос SELECT 1;)

Примеры использования
python install_pgsqk.py "10.10.10.10, 10.0.0.2"
python install_pgsqk.py "192.168.35.247, 172.18.190.225"
python install_pgsqk.py "172.30.45.140,10.255.255.254"



PS
В ходе выполнения задачи была изменена схема выполнения: сначала всё планировалось выполнить в playbook, но в итоге для гибкости решения были созданы шаблонные роли, которые копируются и выполняются в зависимости от целевой системы
Также я столкнулся с проблемой firewall, поэтому прописал открытие нужного порта в firewalld, ufw и iptables.
В качестве пользователя, из-под которого выполняется установка, был выбран root
Нагрузку было решено считать по loadavg 15m / CPU cores.
